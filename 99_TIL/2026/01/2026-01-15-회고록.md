# 📅 2026-01-15 (목) - 일일 학습 기록

## 🚀 오늘 한 일
- [x] SimMonitor → SIMPREC 로그 연동 문제 분석
- [x] 네트워크 연결 상태 확인 (일방향 라우팅 발견)
- [x] SSH 역방향 터널 구성
- [x] Docker 네트워크 설정 (extra_hosts)
- [x] 타임아웃 설정 변경

## 📚 새로 배운 것
### [로그 연동 문제 분석]
- SimMonitor에서 출력되는 로그가 SIMPREC 웹에 표시되지 않음
- `session_events` 테이블 확인 결과 **0건** (로그 저장 안 됨)
- **원인**: SIMPREC 백엔드(Docker)에서 SimMonitor WebSocket(192.168.0.72:8080)에 연결 불가

### [네트워크 구조 분석]
| 방향 | 결과 |
|------|------|
| 개발 PC(10.10.61.137) → 태블릿(192.168.0.72) | 연결 불가 (ping 실패) |
| 태블릿(192.168.0.72) → 개발 PC(10.10.61.137) | 연결 가능 (ping 성공) |

→ **일방향 라우팅**으로 인해 Docker에서 SimMonitor 직접 연결 불가

### [SSH 역방향 터널 구성]
```bash
# 태블릿 PC에서 실행
ssh -R 18080:localhost:8080 ibstplan@10.10.61.137
```
→ 개발 PC `localhost:18080`으로 SimMonitor 접근 성공!

### [Docker 네트워크 설정]
- `docker-compose.dev.yml`에 `extra_hosts` 설정 확인
- eth-simprec 컨테이너 재생성 (down/up)으로 `host.docker.internal` 적용

### [포트 바인딩 문제]
- SSH 터널이 `127.0.0.1`에만 바인딩되어 Docker(172.17.0.1)에서 접근 불가
- **해결 방안**: socat으로 포트 리다이렉트 필요
  - `0.0.0.0:18081` → `127.0.0.1:18080`
- `simmonitor_client.py` 포트 변경 필요 (18080 → 18081)

### [타임아웃 설정]
- App.config의 `Simprec.TimeoutSeconds`: **10초 → 30초** 변경
- 세션 종료 응답이 약 28초 소요되어 기존 10초로는 부족

## 🤔 고민한 부분
- Docker 컨테이너에서 외부 네트워크 접근 방법
- SSH 터널의 바인딩 제한을 어떻게 우회할 것인가

## 📌 내일 할 일
- [ ] socat으로 포트 리다이렉트 구성
- [ ] simmonitor_client.py 포트 변경
- [ ] 전체 시스템 연동 테스트

---
**한 줄 회고**: 네트워크 문제의 원인과 해결책을 찾았다. 내일 socat으로 마무리하자!

**태그**: #네트워크 #SSH터널 #Docker #WebSocket #Troubleshooting
