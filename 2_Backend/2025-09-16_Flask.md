# [Python] Flask와 Docker를 연동한 서비스 자동화 API 서버 구축

## 🤔 문제 상황 (Problem)
- 여러 개의 독립적인 Docker 기반 CBT 환경을 수동으로 생성하고 관리하는 것은 비효율적이고 실수가 잦았다.
- 웹 UI에서 요청을 받아, 파일 생성, Docker 명령어 실행 등 서버의 여러 작업을 자동화할 백엔드 시스템이 필요했다.

## 💡 해결 과정 (Solution)
1.  **Flask 서버 구축:** Python의 경량 웹 프레임워크인 Flask를 사용하여 `/api/environments` 경로로 `POST` 요청을 받는 API 엔드포인트를 만들었다.
2.  **동적 파일 생성:** API가 호출되면, 전달받은 `school_code`, `ports` 등의 변수를 사용하여 `docker-compose.yml`과 `Caddyfile`의 내용을 동적으로 생성했다. Python의 f-string과 `os`, `shutil` 모듈을 적극적으로 활용했다.
3.  **외부 프로세스 실행:** `subprocess` 모듈을 사용하여, 생성된 `docker-compose.yml` 파일을 기반으로 `docker compose up -d`와 `docker exec ... caddy reload` 같은 셸 명령어를 Python 코드 내에서 직접 실행하도록 구현했다.
4.  **에러 핸들링:** `try...except` 블록을 사용하여 파일 생성, Docker 명령어 실행 등 각 단계에서 발생할 수 있는 오류를 잡아내고, 프론트엔드에 명확한 에러 메시지를 반환하도록 처리했다.

## 📖 배운 점 (What I Learned)
- Flask를 이용해 간단한 API 서버를 신속하게 구축하는 방법을 익혔다.
- Python의 `subprocess` 모듈이 Docker 같은 외부 시스템을 제어하는 강력한 자동화 도구가 될 수 있음을 배웠다.
- **동적 설정 주입(Dynamic Configuration Injection)**의 중요성을 이해했다. 하드코딩된 설정 대신, 템플릿과 변수를 활용하여 유연하고 확장 가능한 시스템을 만드는 방법을 체득했다.